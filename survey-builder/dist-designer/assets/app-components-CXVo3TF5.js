import{r as S,j as e,P as z,T as o,B as r,G as f,C as qe,a as _e,b as M,D as Me,c as Ue,d as ne,I as B,e as be,E as Oe,f as $e,g as Ve,h as se,i as Y,A as ae,k as E,l as H,n as He,o as Fe,p as Ge,F as ve,q as fe,M as V,t as he,u as Je,v as xe,w as Se,x as ke,y as Ce,L as we,Y as Te,z as Re,W as Ke,H as Ze,J as ze,K as Pe,N as Xe,O as Ye,Q as oe,U as je,V as ge,X as et,Z as Ie,$ as tt,a0 as rt,a1 as nt,a2 as st,a3 as it,a4 as ot}from"./mui-BPKg0qw8.js";const F=n=>`${n}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,me=()=>({id:F("survey"),title:"New Survey",description:"",welcome:{title:"Welcome",message:"Thank you for participating in our survey."},thankYou:{title:"Thank You!",message:"Your responses have been recorded. Thank you for your time."},settings:{branding:{companyName:"CAPTRS",poweredBy:"Powered by CAPTRS"}},sections:[{id:F("section"),title:"General Questions",description:"Please answer the following questions.",questions:[],order:1}],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),ue=()=>({id:F("question"),type:"text",question:"",required:!1,options:[],order:1}),pe=()=>({id:F("section"),title:"New Section",description:"Section description",questions:[],order:1}),Be=n=>({text:"Text Input",radio:"Multiple Choice",checkbox:"Checkboxes",rating:"Rating Scale",likert:"Likert Scale",yesno:"Yes/No",ranking:"Ranking"})[n]||n,We=n=>({radio:["Option 1","Option 2","Option 3"],checkbox:["Option 1","Option 2","Option 3"],rating:["1","2","3","4","5"],likert:["Strongly Disagree","Disagree","Neutral","Agree","Strongly Agree"],yesno:["Yes","No"],ranking:["Option 1","Option 2","Option 3","Option 4","Option 5"]})[n]||[],De=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ye=n=>n.sections.reduce((p,h)=>p+h.questions.length,0),at=n=>{const p=JSON.stringify(n,null,2),h=new Blob([p],{type:"application/json"}),t=URL.createObjectURL(h),x=document.createElement("a");x.href=t,x.download=`${n.title||"survey"}.json`,x.click(),URL.revokeObjectURL(t)},Ae="survey-library",lt=(n,p)=>{switch(p.type){case"SET_LOADING":return{...n,loading:p.payload};case"SET_SURVEYS":return{...n,surveys:p.payload};case"ADD_SURVEY":return{...n,surveys:[...n.surveys,p.payload]};case"UPDATE_SURVEY":return{...n,surveys:n.surveys.map(t=>t.id===p.payload.id?p.payload:t)};case"DELETE_SURVEY":return{...n,surveys:n.surveys.filter(t=>t.id!==p.payload)};case"DUPLICATE_SURVEY":const h={...p.payload,id:F("survey"),title:`${p.payload.title} (Copy)`,sections:p.payload.sections.map(t=>({...t,id:F("section"),questions:t.questions.map(x=>({...x,id:F("question")}))})),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return{...n,surveys:[...n.surveys,h]};default:return n}},Qe=S.createContext(void 0),Le=()=>{const n=S.useContext(Qe);if(!n)throw new Error("useSurveyContext must be used within a SurveyProvider");return n},jt=({children:n})=>{const[p,h]=S.useReducer(lt,{surveys:[],loading:!0});S.useEffect(()=>{try{const C=localStorage.getItem(Ae);if(C){const g=JSON.parse(C);h({type:"SET_SURVEYS",payload:g.surveys||[]})}else{const g={id:"sample-survey-001",title:"Sample Survey",description:"This is a sample survey to get you started.",welcome:{title:"Welcome to the Survey",message:"Thank you for participating in our survey."},thankYou:{title:"Thank You!",message:"Your responses have been recorded. Thank you for your time."},settings:{branding:{companyName:"CAPTRS",poweredBy:"Powered by CAPTRS"}},sections:[{id:"section-1",title:"General Questions",description:"Please answer the following questions.",questions:[{id:"q1",type:"radio",question:"How satisfied are you with our service?",options:["Very Satisfied","Satisfied","Neutral","Dissatisfied","Very Dissatisfied"],required:!0,order:1},{id:"q2",type:"text",question:"What improvements would you suggest?",required:!1,order:2}],order:1}],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};h({type:"SET_SURVEYS",payload:[g]})}}catch(C){console.error("Error loading survey library:",C),h({type:"SET_SURVEYS",payload:[]})}finally{h({type:"SET_LOADING",payload:!1})}},[]),S.useEffect(()=>{p.loading||localStorage.setItem(Ae,JSON.stringify({surveys:p.surveys}))},[p.surveys,p.loading]);const t=C=>{h({type:"ADD_SURVEY",payload:C})},x=C=>{h({type:"UPDATE_SURVEY",payload:C})},j=C=>{h({type:"DELETE_SURVEY",payload:C})},y=C=>{h({type:"DUPLICATE_SURVEY",payload:C})},w=()=>{const C=me();return t(C),C};return e.jsx(Qe.Provider,{value:{surveys:p.surveys,loading:p.loading,addSurvey:t,updateSurvey:x,deleteSurvey:j,duplicateSurvey:y,createSurvey:w},children:n})},ct=({surveys:n,onEdit:p,onDuplicate:h,onDelete:t,onExport:x,onPreview:j})=>n.length===0?e.jsxs(z,{sx:{p:4,textAlign:"center"},children:[e.jsx(o,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No surveys found"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Create your first survey to get started"})]}):e.jsx(r,{children:e.jsx(f,{container:!0,spacing:3,children:n.map(y=>e.jsx(f,{item:!0,xs:12,md:6,lg:4,children:e.jsxs(qe,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"all 0.2s ease-in-out","&:hover":{transform:"translateY(-2px)",boxShadow:3}},children:[e.jsxs(_e,{sx:{flexGrow:1},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsx(o,{variant:"h6",component:"h3",sx:{fontWeight:"bold"},children:y.title}),e.jsx(M,{label:`${ye(y)} questions`,size:"small",color:"primary",variant:"outlined"})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:y.description||"No description provided"}),e.jsxs(r,{sx:{mb:2},children:[e.jsxs(o,{variant:"caption",color:"text.secondary",children:["Created: ",De(y.createdAt)]}),e.jsx("br",{}),e.jsxs(o,{variant:"caption",color:"text.secondary",children:["Updated: ",De(y.updatedAt)]})]}),e.jsxs(r,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:[y.sections.slice(0,3).map(w=>e.jsx(M,{label:`${w.title} (${w.questions.length})`,size:"small",variant:"outlined",sx:{fontSize:"0.7rem"}},w.id)),y.sections.length>3&&e.jsx(M,{label:`+${y.sections.length-3} more sections`,size:"small",variant:"outlined",sx:{fontSize:"0.7rem"}})]})]}),e.jsx(Me,{}),e.jsxs(Ue,{sx:{justifyContent:"space-between",p:2},children:[e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx(ne,{title:"Preview Survey",children:e.jsx(B,{size:"small",color:"default",onClick:()=>j(y),children:e.jsx(be,{})})}),e.jsx(ne,{title:"Edit Survey",children:e.jsx(B,{size:"small",color:"primary",onClick:()=>p(y),children:e.jsx(Oe,{})})}),e.jsx(ne,{title:"Duplicate Survey",children:e.jsx(B,{size:"small",color:"secondary",onClick:()=>h(y),children:e.jsx($e,{})})}),e.jsx(ne,{title:"Export Survey",children:e.jsx(B,{size:"small",color:"info",onClick:()=>x(y),children:e.jsx(Ve,{})})})]}),e.jsx(ne,{title:"Delete Survey",children:e.jsx(B,{size:"small",color:"error",onClick:()=>t(y),children:e.jsx(se,{})})})]})]})},y.id))})}),dt=({steps:n,initialStep:p=0})=>{const[h,t]=S.useState(p),[x,j]=S.useState({}),y=n[h],w=h===0,C=h===n.length-1,g=S.useCallback(v=>{v>=0&&v<n.length&&t(v)},[n.length]),D=S.useCallback(()=>{C||t(v=>v+1)},[C]),O=S.useCallback(()=>{w||t(v=>v-1)},[w]),Q=S.useCallback(v=>{const L=n.findIndex(a=>a.id===v);L!==-1&&t(L)},[n]),N=S.useCallback((v,L)=>{j(a=>({...a,[v]:{...a[v],...L}}))},[]),T=S.useCallback(v=>x[v]||{},[x]),I=S.useCallback(()=>{t(p),j({})},[p]);return{currentStep:y,currentStepIndex:h,isFirstStep:w,isLastStep:C,totalSteps:n.length,goToStep:g,nextStep:D,previousStep:O,goToStepById:Q,setStepDataValue:N,getStepData:T,resetWizard:I,stepData:x}},xt=({data:n,survey:p,onChange:h})=>{const t=(x,j)=>{h({...n,[x]:j})};return e.jsxs(r,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Basic Survey Information"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Provide the basic details for your survey. This information will be displayed to participants."}),e.jsx(z,{sx:{p:3},children:e.jsxs(f,{container:!0,spacing:3,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,label:"Survey Title",value:n.title||p.title,onChange:x=>t("title",x.target.value),placeholder:"Enter a descriptive title for your survey",helperText:"This will be the main title shown to participants"})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,multiline:!0,rows:4,label:"Survey Description",value:n.description||p.description,onChange:x=>t("description",x.target.value),placeholder:"Describe what this survey is about and what participants can expect",helperText:"Provide context about the survey purpose and estimated completion time"})})]})})]})},ut=({data:n,survey:p,onChange:h})=>{const t=(x,j)=>{h({...n,[x]:j})};return e.jsxs(r,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Welcome Section"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Create a welcoming message that participants will see when they start the survey."}),e.jsx(ae,{severity:"info",sx:{mb:3},children:"A good welcome message should explain the purpose of the survey, how long it will take, and what participants can expect."}),e.jsx(z,{sx:{p:3},children:e.jsxs(f,{container:!0,spacing:3,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,label:"Welcome Title",value:n.title||p.welcome.title,onChange:x=>t("title",x.target.value),placeholder:"Welcome to our survey",helperText:"A brief, friendly title for the welcome screen"})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,multiline:!0,rows:6,label:"Welcome Message",value:n.message||p.welcome.message,onChange:x=>t("message",x.target.value),placeholder:"Thank you for participating in our survey. This will help us understand your needs and improve our services. The survey should take about 5-10 minutes to complete.",helperText:"Provide a clear, welcoming message that sets expectations"})})]})})]})},pt=({data:n,survey:p,onChange:h})=>{var te;const[t,x]=S.useState(null),[j,y]=S.useState(-1),[w,C]=S.useState(-1),[g,D]=S.useState(ue()),[O,Q]=S.useState(pe()),[N,T]=S.useState(!1),[I,v]=S.useState(new Set),[L,a]=S.useState(new Set([0])),s=n.sections||p.sections||[],R=l=>{switch(l){case"text":return e.jsx(xe,{});case"radio":return e.jsx(Se,{});case"checkbox":return e.jsx(ke,{});case"rating":return e.jsx(Ce,{});case"likert":return e.jsx(we,{});case"yesno":return e.jsx(Te,{});case"ranking":return e.jsx(Re,{});default:return e.jsx(xe,{})}},_=[{value:"text",label:"Text Input",icon:e.jsx(xe,{}),desc:"Free text response"},{value:"radio",label:"Multiple Choice",icon:e.jsx(Se,{}),desc:"Single selection"},{value:"checkbox",label:"Checkboxes",icon:e.jsx(ke,{}),desc:"Multiple selection"},{value:"rating",label:"Rating Scale",icon:e.jsx(Ce,{}),desc:"1-5 scale"},{value:"likert",label:"Likert Scale",icon:e.jsx(we,{}),desc:"Agreement levels"},{value:"yesno",label:"Yes/No",icon:e.jsx(Te,{}),desc:"Binary choice"},{value:"ranking",label:"Ranking",icon:e.jsx(Re,{}),desc:"Drag to reorder"}],G=l=>{const c=new Set(L);c.has(l)?c.delete(l):c.add(l),a(c)},J=l=>{if(l<=0)return;const c=[...s],d=c[l];c[l]=c[l-1],c[l-1]=d;const i=c.map((m,k)=>({...m,order:k+1}));h({sections:i})},$=l=>{if(l>=s.length-1)return;const c=[...s],d=c[l];c[l]=c[l+1],c[l+1]=d;const i=c.map((m,k)=>({...m,order:k+1}));h({sections:i})},u=()=>{if(!O.title.trim())return;const l=[...s,{...O,order:s.length+1}];h({sections:l}),Q(pe()),T(!1)},P=l=>{const c=s.filter((d,i)=>i!==l);h({sections:c})},q=(l,c,d)=>{const i=[...s];i[l]={...i[l],[c]:d},h({sections:i})},A=l=>{if(!g.question.trim())return;const c=[...s],d=c[l],i=[...d.questions,{...g,order:d.questions.length+1}];c[l]={...d,questions:i},h({sections:c}),D(ue());const m=new Set(I);m.delete(l),v(m)},K=(l,c)=>{x({...s[l].questions[c]}),y(c),C(l)},le=()=>{if(!t||j===-1||w===-1)return;const l=[...s],c=l[w],d=[...c.questions];d[j]=t,l[w]={...c,questions:d},h({sections:l}),x(null),y(-1),C(-1)},ce=()=>{x(null),y(-1),C(-1)},de=(l,c)=>{const d=[...s],i=d[l],m=i.questions.filter((k,b)=>b!==c);d[l]={...i,questions:m},h({sections:d})},ie=(l,c)=>{const d={...l,type:c};["radio","checkbox","rating","likert","ranking"].includes(c)?d.options=We(c):d.options=[],t?x(d):D(d)},Z=(l,c,d)=>{const i=[...l.options||[]];i[c]=d;const m={...l,options:i};t?x(m):D(m)},X=l=>{const c=[...l.options||[],""],d={...l,options:c};t?x(d):D(d)},ee=(l,c)=>{var m;const d=((m=l.options)==null?void 0:m.filter((k,b)=>b!==c))||[],i={...l,options:d};t?x(i):D(i)};return e.jsxs(r,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Survey Questions"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:4},children:"Organize your survey into sections and add questions. Each section can have its own theme and multiple questions."}),e.jsxs(r,{sx:{mb:4},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(o,{variant:"h6",sx:{color:"primary.main",fontWeight:600},children:["Sections (",s.length,")"]}),e.jsx(E,{variant:"contained",startIcon:e.jsx(H,{}),onClick:()=>T(!0),sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Add Section"})]}),N&&e.jsxs(z,{sx:{p:3,mb:3,border:"2px solid",borderColor:"primary.light",borderRadius:2},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"h6",sx:{color:"primary.main"},children:"Create New Section"}),e.jsx(E,{variant:"outlined",size:"small",onClick:()=>{T(!1),Q(pe())},children:"Cancel"})]}),e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Y,{fullWidth:!0,label:"Section Title",value:O.title,onChange:l=>Q({...O,title:l.target.value}),placeholder:"e.g., Personal Information, Feedback Questions"})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Y,{fullWidth:!0,label:"Section Description (Optional)",value:O.description,onChange:l=>Q({...O,description:l.target.value}),placeholder:"Brief description of this section",multiline:!0,rows:2})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(E,{variant:"contained",startIcon:e.jsx(H,{}),onClick:u,disabled:!O.title.trim(),sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Create Section"})})]})]})]}),e.jsx(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:s.map((l,c)=>{var d;return e.jsxs(z,{sx:{borderRadius:3,border:"1px solid",borderColor:"divider",overflow:"hidden",boxShadow:1,transition:"all 0.2s ease","&:hover":{boxShadow:"0 4px 16px rgba(24, 26, 67, 0.1)"}},children:[e.jsx(r,{sx:{p:3,backgroundColor:"grey.50",borderBottom:"1px solid",borderColor:"divider"},children:e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"flex-start",gap:2,flex:1},children:[e.jsxs(r,{sx:{display:"flex",flexDirection:"column",mt:.5},children:[e.jsx(B,{size:"small",onClick:()=>J(c),disabled:c===0,sx:{backgroundColor:"background.paper",padding:"2px","&:hover":{backgroundColor:"action.hover"},"&:disabled":{opacity:.3}},children:e.jsx(He,{fontSize:"small"})}),e.jsx(B,{size:"small",onClick:()=>$(c),disabled:c===s.length-1,sx:{backgroundColor:"background.paper",padding:"2px","&:hover":{backgroundColor:"action.hover"},"&:disabled":{opacity:.3}},children:e.jsx(Fe,{fontSize:"small"})})]}),e.jsxs(r,{sx:{flex:1},children:[e.jsx(o,{variant:"h6",sx:{color:"primary.main",fontWeight:600,mb:1},children:l.title}),l.description&&e.jsx(o,{variant:"body2",color:"text.secondary",children:l.description})]})]}),e.jsxs(r,{sx:{display:"flex",gap:1,alignItems:"center",ml:2},children:[e.jsx(M,{label:`${l.questions.length} questions`,size:"small",sx:{backgroundColor:"primary.main",color:"primary.contrastText",fontWeight:500}}),e.jsx(B,{size:"small",onClick:()=>G(c),sx:{backgroundColor:"background.paper","&:hover":{backgroundColor:"action.hover"}},children:e.jsx(Ge,{sx:{transform:L.has(c)?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s"}})}),e.jsx(B,{size:"small",color:"error",onClick:()=>P(c),disabled:s.length===1,sx:{backgroundColor:"white","&:hover":{backgroundColor:"error.light",opacity:.1}},children:e.jsx(se,{})})]})]})}),L.has(c)&&e.jsxs(r,{sx:{p:3},children:[e.jsxs(r,{sx:{mb:4},children:[e.jsx(o,{variant:"subtitle1",sx:{fontWeight:600,mb:2,color:"primary.main"},children:"Section Settings"}),e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Y,{fullWidth:!0,label:"Section Title",value:l.title,onChange:i=>q(c,"title",i.target.value),variant:"outlined"})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(Y,{fullWidth:!0,label:"Section Description",value:l.description,onChange:i=>q(c,"description",i.target.value),multiline:!0,rows:2,variant:"outlined",placeholder:"Optional description for this section"})})]})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(o,{variant:"subtitle1",sx:{fontWeight:600,color:"primary.main"},children:["Questions (",l.questions.length,")"]}),e.jsx(E,{variant:"outlined",startIcon:e.jsx(H,{}),onClick:()=>{const i=new Set(I);i.add(c),v(i)},size:"small",sx:{borderColor:"primary.main",color:"primary.main","&:hover":{borderColor:"primary.main",backgroundColor:"primary.main",color:"primary.contrastText"}},children:"Add Question"})]}),I.has(c)&&e.jsxs(z,{sx:{p:3,mb:3,border:"2px solid",borderColor:"primary.light",borderRadius:2},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,sx:{color:"primary.main"},children:"Add New Question"}),e.jsxs(f,{container:!0,spacing:3,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,label:"Question Text",value:g.question,onChange:i=>D({...g,question:i.target.value}),placeholder:"What would you like to ask?",variant:"outlined"})}),e.jsxs(f,{item:!0,xs:12,children:[e.jsx(o,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:600},children:"Question Type"}),e.jsx(f,{container:!0,spacing:1,children:_.map(i=>e.jsx(f,{item:!0,xs:6,sm:4,md:3,children:e.jsxs(z,{sx:{p:2,textAlign:"center",cursor:"pointer",border:g.type===i.value?"2px solid":"1px solid",borderColor:g.type===i.value?"primary.main":"divider",backgroundColor:g.type===i.value?"primary.light":"background.paper","&:hover":{borderColor:"primary.main",backgroundColor:"primary.light"},transition:"all 0.2s"},onClick:()=>D({...g,type:i.value,options:We(i.value)}),children:[e.jsx(r,{sx:{color:g.type===i.value?"primary.main":"text.secondary",mb:1},children:i.icon}),e.jsx(o,{variant:"caption",sx:{fontWeight:g.type===i.value?600:400,color:g.type===i.value?"primary.main":"text.primary",display:"block",lineHeight:1.2},children:i.label}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontSize:"0.7rem"},children:i.desc})]})},i.value))})]}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(ve,{control:e.jsx(fe,{checked:g.required,onChange:i=>D({...g,required:i.target.checked}),sx:{"& .MuiSwitch-switchBase.Mui-checked":{color:"primary.main"},"& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track":{backgroundColor:"primary.main"}}}),label:"Required Question",sx:{mt:1}})}),(g.type==="radio"||g.type==="checkbox"||g.type==="rating"||g.type==="likert"||g.type==="yesno"||g.type==="ranking")&&e.jsxs(f,{item:!0,xs:12,children:[e.jsx(o,{variant:"subtitle2",gutterBottom:!0,sx:{fontWeight:600},children:"Answer Options"}),(d=g.options)==null?void 0:d.map((i,m)=>e.jsxs(r,{sx:{display:"flex",gap:1,mb:1},children:[e.jsx(Y,{fullWidth:!0,size:"small",value:i,onChange:k=>Z(g,m,k.target.value),placeholder:`Option ${m+1}`,variant:"outlined"}),e.jsx(B,{size:"small",onClick:()=>ee(g,m),color:"error",sx:{"&:hover":{backgroundColor:"error.light",opacity:.1}},children:e.jsx(se,{})})]},m)),e.jsx(E,{variant:"outlined",size:"small",startIcon:e.jsx(H,{}),onClick:()=>X(g),sx:{borderColor:"primary.main",color:"primary.main","&:hover":{borderColor:"primary.main",backgroundColor:"primary.light"}},children:"Add Option"})]}),e.jsx(f,{item:!0,xs:12,children:e.jsxs(r,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(E,{variant:"outlined",onClick:()=>{const i=new Set(I);i.delete(c),v(i),D(ue())},size:"medium",children:"Cancel"}),e.jsx(E,{variant:"contained",startIcon:e.jsx(H,{}),onClick:()=>A(c),disabled:!g.question.trim(),sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Add Question"})]})})]})]}),l.questions.length>0?e.jsx(r,{sx:{display:"flex",flexDirection:"column",gap:2},children:l.questions.map((i,m)=>e.jsx(z,{sx:{p:3,border:"1px solid",borderColor:"divider",borderRadius:2,"&:hover":{borderColor:"primary.main",boxShadow:2},transition:"all 0.2s"},children:e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[e.jsxs(r,{sx:{flex:1},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2,mb:1},children:[e.jsx(r,{sx:{color:"primary.main"},children:R(i.type)}),e.jsxs(o,{variant:"body1",sx:{fontWeight:500,color:"primary.main"},children:["Q",m+1,". ",i.question]})]}),e.jsxs(r,{sx:{display:"flex",gap:1,flexWrap:"wrap",ml:4},children:[e.jsx(M,{label:Be(i.type),size:"small",variant:"outlined",sx:{borderColor:"primary.main",color:"primary.main"}}),e.jsx(M,{label:i.required?"Required":"Optional",size:"small",color:i.required?"primary":"default",sx:i.required?{backgroundColor:"primary.main",color:"primary.contrastText"}:{}})]})]}),e.jsxs(r,{sx:{display:"flex",gap:1,ml:2},children:[e.jsx(B,{size:"small",onClick:()=>K(c,m),sx:{color:"primary.main","&:hover":{backgroundColor:"primary.light"}},children:e.jsx(Oe,{})}),e.jsx(B,{size:"small",color:"error",onClick:()=>de(c,m),sx:{"&:hover":{backgroundColor:"error.light",opacity:.1}},children:e.jsx(se,{})})]})]})},i.id))}):e.jsx(r,{sx:{textAlign:"center",py:4,color:"text.secondary",border:"1px dashed",borderColor:"divider",borderRadius:2,backgroundColor:"background.paper"},children:e.jsx(o,{variant:"body2",children:'No questions yet. Click "Add Question" to get started.'})})]})]})]},l.id)})}),t&&e.jsxs(z,{sx:{p:3,mt:3,border:"2px solid",borderColor:"primary.main"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Edit Question"}),e.jsxs(f,{container:!0,spacing:2,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,label:"Question Text",value:t.question,onChange:l=>x({...t,question:l.target.value})})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsxs(Y,{fullWidth:!0,label:"Question Type",value:t.type,onChange:l=>ie(t,l.target.value),select:!0,children:[e.jsx(V,{value:"text",children:"Text Input"}),e.jsx(V,{value:"radio",children:"Multiple Choice"}),e.jsx(V,{value:"checkbox",children:"Checkboxes"}),e.jsx(V,{value:"rating",children:"Rating Scale"}),e.jsx(V,{value:"likert",children:"Likert Scale"}),e.jsx(V,{value:"yesno",children:"Yes/No"}),e.jsx(V,{value:"ranking",children:"Ranking"})]})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsx(ve,{control:e.jsx(fe,{checked:t.required,onChange:l=>x({...t,required:l.target.checked})}),label:"Required Question"})}),["radio","checkbox","rating","likert","ranking"].includes(t.type)&&e.jsxs(f,{item:!0,xs:12,children:[e.jsx(o,{variant:"subtitle2",gutterBottom:!0,children:"Options"}),(te=t.options)==null?void 0:te.map((l,c)=>e.jsxs(r,{sx:{display:"flex",gap:1,mb:1},children:[e.jsx(Y,{size:"small",value:l,onChange:d=>Z(t,c,d.target.value),placeholder:`Option ${c+1}`,sx:{flexGrow:1}}),e.jsx(B,{size:"small",color:"error",onClick:()=>ee(t,c),children:e.jsx(se,{})})]},c)),e.jsx(E,{size:"small",startIcon:e.jsx(H,{}),onClick:()=>X(t),children:"Add Option"})]}),e.jsx(f,{item:!0,xs:12,children:e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx(E,{variant:"contained",startIcon:e.jsx(he,{}),onClick:le,children:"Save Changes"}),e.jsx(E,{variant:"outlined",startIcon:e.jsx(Je,{}),onClick:ce,children:"Cancel"})]})})]})]})]})},ht=({data:n,survey:p,onChange:h})=>{const t=(x,j)=>{h({...n,[x]:j})};return e.jsxs(r,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Thank You Section"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Create a thank you message that participants will see when they complete the survey."}),e.jsx(ae,{severity:"info",sx:{mb:3},children:"A good thank you message should acknowledge the participant's time, explain what happens next, and provide any relevant contact information."}),e.jsx(z,{sx:{p:3},children:e.jsxs(f,{container:!0,spacing:3,children:[e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,label:"Thank You Title",value:n.title||p.thankYou.title,onChange:x=>t("title",x.target.value),placeholder:"Thank you for your participation",helperText:"A brief, appreciative title for the completion screen"})}),e.jsx(f,{item:!0,xs:12,children:e.jsx(Y,{fullWidth:!0,multiline:!0,rows:6,label:"Thank You Message",value:n.message||p.thankYou.message,onChange:x=>t("message",x.target.value),placeholder:"Thank you for taking the time to complete our survey. Your feedback is valuable and will help us improve our services. We appreciate your participation and will use your responses to make positive changes.",helperText:"Provide a warm, appreciative message that acknowledges their time and explains next steps"})})]})})]})},gt=({survey:n})=>{const p=ye(n)>0,h=n.welcome.title.trim()&&n.welcome.message.trim(),t=n.thankYou.title.trim()&&n.thankYou.message.trim(),x=n.title.trim(),j=n.description.trim(),y=p&&h&&t&&x;return e.jsxs(r,{children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Review Your Survey"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Review all the information before creating your survey. Make sure everything looks correct."}),!y&&e.jsxs(ae,{severity:"warning",sx:{mb:3},children:[e.jsx(Ke,{sx:{mr:1}}),"Please complete all required sections before creating your survey."]}),e.jsxs(f,{container:!0,spacing:3,children:[e.jsx(f,{item:!0,xs:12,md:6,children:e.jsxs(z,{sx:{p:3,height:"100%"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Basic Information"}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",children:"Survey Title"}),e.jsx(o,{variant:"body1",children:x?n.title:"Not provided"})]}),e.jsxs(r,{children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",children:"Description"}),e.jsx(o,{variant:"body1",children:j?n.description:"Not provided"})]})]})}),e.jsx(f,{item:!0,xs:12,md:6,children:e.jsxs(z,{sx:{p:3,height:"100%"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Welcome Section"}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",children:"Welcome Title"}),e.jsx(o,{variant:"body1",children:h?n.welcome.title:"Not provided"})]}),e.jsxs(r,{children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",children:"Welcome Message"}),e.jsx(o,{variant:"body1",children:h?n.welcome.message.substring(0,100)+"...":"Not provided"})]})]})}),e.jsx(f,{item:!0,xs:12,children:e.jsxs(z,{sx:{p:3},children:[e.jsxs(o,{variant:"h6",gutterBottom:!0,children:["Questions (",ye(n)," total questions in ",n.sections.length," sections)"]}),p?e.jsx(r,{children:n.sections.map((w,C)=>e.jsxs(r,{sx:{mb:3,p:2,border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(o,{variant:"h6",children:["Section ",C+1,": ",w.title]}),e.jsx(M,{label:`${w.questions.length} questions`,size:"small",color:"primary",variant:"outlined"})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:w.description}),w.questions.map((g,D)=>e.jsxs(r,{sx:{mb:2,p:2,backgroundColor:"background.paper",borderRadius:1},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[e.jsxs(o,{variant:"subtitle1",children:[D+1,". ",g.question]}),e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx(M,{label:Be(g.type),size:"small",variant:"outlined"}),e.jsx(M,{label:g.required?"Required":"Optional",size:"small",color:g.required?"primary":"default"})]})]}),g.options&&g.options.length>0&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Options: ",g.options.join(", ")]})]},g.id))]},w.id))}):e.jsx(o,{variant:"body2",color:"text.secondary",children:"No questions added yet."})]})}),e.jsx(f,{item:!0,xs:12,children:e.jsxs(z,{sx:{p:3},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Thank You Section"}),e.jsxs(r,{sx:{mb:2},children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",children:"Thank You Title"}),e.jsx(o,{variant:"body1",children:t?n.thankYou.title:"Not provided"})]}),e.jsxs(r,{children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",children:"Thank You Message"}),e.jsx(o,{variant:"body1",children:t?n.thankYou.message:"Not provided"})]})]})})]})]})},Ne=({survey:n,open:p,onClose:h})=>{const t=Ze(),[x,j]=S.useState({currentSectionIndex:-1,answers:{},isCompleted:!1}),y=()=>{j(a=>({...a,currentSectionIndex:0}))},w=()=>{var a;x.currentSectionIndex<(((a=n.sections)==null?void 0:a.length)||0)-1?j(s=>({...s,currentSectionIndex:s.currentSectionIndex+1})):j(s=>({...s,isCompleted:!0}))},C=()=>{x.currentSectionIndex>0?j(a=>({...a,currentSectionIndex:a.currentSectionIndex-1})):j(a=>({...a,currentSectionIndex:-1}))},g=(a,s)=>{j(R=>({...R,answers:{...R.answers,[a]:s}}))},D=()=>{j({currentSectionIndex:-1,answers:{},isCompleted:!1})},O=()=>{var a,s;return e.jsxs(r,{sx:{textAlign:"center",py:6},children:[e.jsx(o,{variant:"h4",sx:{mb:3,fontWeight:"bold",color:"primary.main"},children:((a=n.welcome)==null?void 0:a.title)||"Welcome to the Survey"}),e.jsx(o,{variant:"body1",sx:{mb:4,color:"text.secondary",maxWidth:600,mx:"auto"},children:((s=n.welcome)==null?void 0:s.message)||"Thank you for participating in this survey. Please click the button below to begin."}),e.jsx(E,{variant:"contained",size:"large",onClick:y,sx:{px:4,py:1.5,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Start Survey"})]})},Q=a=>{var _,G,J;const s=x.answers[a.id],R=$=>{g(a.id,$)};switch(a.type){case"text":return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsx("textarea",{value:s||"",onChange:u=>R(u.target.value),placeholder:"Enter your answer...",style:{width:"100%",minHeight:"120px",padding:"12px",border:"2px solid",borderColor:"divider",borderRadius:"8px",fontFamily:"inherit",fontSize:"16px",resize:"vertical"}})]});case"radio":return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsx(o,{variant:"body2",sx:{mb:2,color:"text.secondary",fontStyle:"italic"},children:"Select one option"}),e.jsx(r,{sx:{display:"flex",flexDirection:"row",gap:2,flexWrap:"wrap",width:"100%",justifyContent:"space-between"},children:(_=a.options)==null?void 0:_.map(u=>e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"8px 12px",border:"2px solid",borderColor:s===u?t.palette.primary.main:t.palette.divider,borderRadius:"6px",backgroundColor:s===u?t.palette.action.selected:t.palette.background.paper,flex:1,minWidth:0,justifyContent:"center",gap:"8px"},children:[e.jsx("input",{type:"radio",name:a.id,value:u,checked:s===u,onChange:P=>R(P.target.value),style:{flexShrink:0}}),e.jsx("span",{style:{flex:1,textAlign:"center",color:t.palette.text.primary},children:u})]},u))})]});case"checkbox":return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsx(o,{variant:"body2",sx:{mb:2,color:"text.secondary",fontStyle:"italic"},children:"Select all that apply"}),e.jsx(r,{sx:{display:"flex",flexDirection:"row",gap:2,flexWrap:"wrap",width:"100%",justifyContent:"space-between"},children:(G=a.options)==null?void 0:G.map(u=>e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"8px 12px",border:"2px solid",borderColor:Array.isArray(s)&&s.includes(u)?t.palette.primary.main:t.palette.divider,borderRadius:"6px",backgroundColor:Array.isArray(s)&&s.includes(u)?t.palette.action.selected:t.palette.background.paper,flex:1,minWidth:0,justifyContent:"center",gap:"8px"},children:[e.jsx("input",{type:"checkbox",value:u,checked:Array.isArray(s)&&s.includes(u),onChange:P=>{const q=Array.isArray(s)?s:[];P.target.checked?R([...q,u]):R(q.filter(A=>A!==u))},style:{flexShrink:0}}),e.jsx("span",{style:{flex:1,textAlign:"center",color:t.palette.text.primary},children:u})]},u))})]});case"likert":return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsx(r,{sx:{display:"flex",flexDirection:"row",gap:2,flexWrap:"wrap",width:"100%",justifyContent:"space-between",alignItems:"stretch"},children:(J=a.options)==null?void 0:J.map(u=>e.jsxs(r,{component:"label",sx:{display:"flex",alignItems:"center",cursor:"pointer",padding:"8px 12px",border:"2px solid",borderColor:s===u?"primary.main":"divider",borderRadius:"6px",backgroundColor:s===u?"action.selected":"background.paper",flex:1,minWidth:0,justifyContent:"center",textAlign:"center",flexDirection:"row",gap:"8px"},children:[e.jsx("input",{type:"checkbox",name:a.id,value:u,checked:s===u,onChange:P=>R(P.target.value),style:{flexShrink:0}}),e.jsx("span",{style:{flex:1,textAlign:"center",color:t.palette.text.primary},children:u})]},u))})]});case"rating":return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsx(r,{sx:{display:"flex",gap:"0.5rem",marginTop:"1rem",alignItems:"center"},children:[1,2,3,4,5].map(u=>{const P=s&&u<=s;return e.jsxs(r,{component:"label",sx:{fontSize:"1.5rem",color:P?t.palette.warning.main:t.palette.grey[400],cursor:"pointer",transition:"color 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px","&:hover":{color:t.palette.warning.main}},onClick:()=>R(u),children:[e.jsx("input",{type:"radio",name:a.id,value:u.toString(),checked:s===u,onChange:()=>R(u),style:{position:"absolute",opacity:0,pointerEvents:"none"}}),e.jsx("span",{style:{display:"block"},children:"â˜…"})]},u)})})]});case"yesno":return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsx(r,{sx:{display:"flex",gap:2,width:"100%",justifyContent:"space-between"},children:["Yes","No"].map(u=>e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",padding:"8px 24px",border:"2px solid",borderColor:s===u?t.palette.primary.main:t.palette.divider,borderRadius:"6px",backgroundColor:s===u?t.palette.action.selected:t.palette.background.paper,flex:1,minWidth:0,justifyContent:"center",gap:"8px"},children:[e.jsx("input",{type:"radio",name:a.id,value:u,checked:s===u,onChange:P=>R(P.target.value),style:{flexShrink:0}}),e.jsx("span",{style:{flex:1,textAlign:"center",color:t.palette.text.primary},children:u})]},u))})]});case"ranking":const $=()=>{var ie,Z,X,ee,te,l,c;const[u,P]=Ie.useState(null),q=(d,i)=>{P(i),d.dataTransfer.effectAllowed="move",d.dataTransfer.setData("text/plain",i);const m=d.currentTarget;m.style.opacity="0.5",m.style.transform="rotate(2deg)"},A=d=>{P(null);const i=d.currentTarget;i.style.opacity="",i.style.transform="",document.querySelectorAll(".ranking-item-preview").forEach(k=>{k.classList.remove("drag-over")})},K=(d,i)=>{if(!u||u===i)return;d.preventDefault(),d.dataTransfer.dropEffect="move",d.currentTarget.classList.add("drag-over")},le=d=>{d.currentTarget.classList.remove("drag-over")},ce=(d,i)=>{var U;if(!u||u===i)return;d.preventDefault(),d.currentTarget.classList.remove("drag-over");const k=s?{...s}:{},b=k[u],W=k[i];if(b&&W)k[u]=W,k[i]=b;else if(b&&!W)delete k[u],k[i]=b;else if(!b&&W)k[u]=W,delete k[i];else{const re=de(k,((U=a.options)==null?void 0:U.length)||0);k[u]=re}R(k)},de=(d,i)=>{const m=Object.values(d);if(m.length===0)return 1;for(let k=1;k<=i;k++)if(!m.includes(k))return k;return 0};return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsx(o,{variant:"body2",sx:{mb:2,color:"text.secondary",fontStyle:"italic"},children:"Drag and drop options to rank them, or click to toggle ranking. Higher ranked items appear at the top."}),e.jsx(r,{sx:{mb:2,p:2,borderRadius:"6px",fontSize:"14px",fontWeight:"500",backgroundColor:Object.keys(s||{}).length===((ie=a.options)==null?void 0:ie.length)?t.palette.success.light:t.palette.warning.light,color:Object.keys(s||{}).length===((Z=a.options)==null?void 0:Z.length)?t.palette.success.dark:t.palette.warning.dark,border:Object.keys(s||{}).length===((X=a.options)==null?void 0:X.length)?`1px solid ${t.palette.success.main}`:`1px solid ${t.palette.warning.main}`},children:Object.keys(s||{}).length===((ee=a.options)==null?void 0:ee.length)?`All ${(te=a.options)==null?void 0:te.length} options ranked`:`${Object.keys(s||{}).length} of ${(l=a.options)==null?void 0:l.length} options ranked`}),e.jsx(r,{sx:{display:"flex",flexDirection:"column",gap:2},children:(c=a.options)==null?void 0:c.sort((d,i)=>{const m=(s==null?void 0:s[d])||0,k=(s==null?void 0:s[i])||0;return m===0&&k===0?0:m===0?1:k===0?-1:m-k}).map(d=>{const i=(s==null?void 0:s[d])>0,m=(s==null?void 0:s[d])||0,k=Object.keys(s||{}).length;return e.jsxs(r,{className:"ranking-item-preview",sx:{display:"flex",alignItems:"center",gap:2,padding:"12px 16px",border:"2px solid",borderColor:i?t.palette.primary.main:t.palette.divider,borderRadius:"8px",backgroundColor:i?t.palette.action.selected:t.palette.background.paper,cursor:"grab",position:"relative",transition:"all 0.2s ease","&:hover":{borderColor:t.palette.primary.main,backgroundColor:t.palette.action.hover,transform:"translateY(-1px)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},"&:active":{cursor:"grabbing"},"&.drag-over":{borderColor:t.palette.primary.main,backgroundColor:t.palette.action.selected,transform:"scale(1.02)",boxShadow:"0 4px 8px rgba(67, 88, 163, 0.3)"}},draggable:!0,onDragStart:b=>q(b,d),onDragEnd:A,onDragOver:b=>K(b,d),onDragLeave:le,onDrop:b=>ce(b,d),onClick:()=>{const b=s||{};if(b[d]){const W={...b};delete W[d],R(W)}else{const W=Object.keys(b).length+1;R({...b,[d]:W})}},children:[e.jsx(r,{sx:{color:t.palette.grey[400],fontSize:"18px",cursor:"grab",userSelect:"none",flexShrink:0,width:"16px",textAlign:"center","&:active":{cursor:"grabbing"}},children:"â‹®â‹®"}),e.jsx(r,{sx:{width:"32px",height:"32px",border:"2px solid",borderColor:i?t.palette.primary.main:t.palette.divider,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",fontSize:"14px",backgroundColor:i?t.palette.primary.main:t.palette.background.paper,color:i?t.palette.primary.contrastText:t.palette.text.secondary},children:i?m:""}),e.jsx("span",{style:{flex:1,fontWeight:"500"},children:d}),e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:1,flexShrink:0},children:[i&&m>1&&e.jsx("button",{onClick:b=>{b.stopPropagation();const W={...s},U=Object.keys(W).find(re=>W[re]===m-1);U&&(W[d]=m-1,W[U]=m,R(W))},style:{background:"none",border:"none",color:t.palette.success.main,fontSize:"16px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"all 0.2s",minWidth:"24px",minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=t.palette.success.light,b.currentTarget.style.color=t.palette.success.dark},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="transparent",b.currentTarget.style.color=t.palette.success.main},children:"â†‘"}),i&&m<k&&e.jsx("button",{onClick:b=>{b.stopPropagation();const W={...s},U=Object.keys(W).find(re=>W[re]===m+1);U&&(W[d]=m+1,W[U]=m,R(W))},style:{background:"none",border:"none",color:t.palette.warning.main,fontSize:"16px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"all 0.2s",minWidth:"24px",minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=t.palette.warning.light,b.currentTarget.style.color=t.palette.warning.dark},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="transparent",b.currentTarget.style.color=t.palette.warning.main},children:"â†“"}),i&&e.jsx("button",{onClick:b=>{b.stopPropagation();const W={...s};delete W[d],R(W)},style:{background:"none",border:"none",color:t.palette.text.secondary,fontSize:"18px",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"all 0.2s",minWidth:"24px",minHeight:"24px",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:b=>{b.currentTarget.style.backgroundColor=t.palette.error.light,b.currentTarget.style.color=t.palette.error.dark},onMouseLeave:b=>{b.currentTarget.style.backgroundColor="transparent",b.currentTarget.style.color=t.palette.text.secondary},children:"Ã—"})]})]},d)})})]})};return Ie.createElement($);default:return e.jsxs(r,{sx:{mb:3},children:[e.jsxs(o,{variant:"h6",sx:{mb:2,fontWeight:"semibold",display:"flex",alignItems:"center",gap:1},children:[a.required&&e.jsx("span",{style:{color:"error.main",order:-1},children:"*"}),a.question]}),e.jsxs(o,{variant:"body2",sx:{color:"error.main"},children:['Question type "',a.type,'" is not supported in preview mode.']})]})}},N=(a,s)=>e.jsxs(r,{sx:{mb:4},children:[e.jsxs(o,{variant:"h5",sx:{mb:3,fontWeight:"bold",color:"primary.main"},children:[s+1,". ",a.title]}),a.description&&e.jsx(o,{variant:"body1",sx:{mb:3,color:"text.secondary"},children:a.description}),a.questions.map(R=>e.jsx(z,{sx:{p:3,mb:3,border:"1px solid",borderColor:"divider"},children:Q(R)},R.id))]},a.id),T=()=>{var a,s;return e.jsxs(r,{sx:{textAlign:"center",py:6},children:[e.jsx(o,{variant:"h4",sx:{mb:3,fontWeight:"bold",color:"primary.main"},children:((a=n.thankYou)==null?void 0:a.title)||"Thank You!"}),e.jsx(o,{variant:"body1",sx:{mb:4,color:"text.secondary",maxWidth:600,mx:"auto"},children:((s=n.thankYou)==null?void 0:s.message)||"Thank you for completing this survey. Your responses have been recorded."}),e.jsx(E,{variant:"outlined",onClick:D,sx:{borderColor:"primary.main",color:"primary.main"},children:"Preview Again"})]})},I=()=>{var _;if(x.currentSectionIndex===-1||x.isCompleted)return null;const a=((_=n.sections)==null?void 0:_.length)||0,s=x.currentSectionIndex+1,R=s/a*100;return e.jsxs(r,{sx:{mb:4},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Question ",s," of ",a]}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:[Math.round(R),"%"]})]}),e.jsx(je,{variant:"determinate",value:R,sx:{height:8,borderRadius:4}})]})},v=()=>{var R;if(x.currentSectionIndex===-1||x.isCompleted)return null;const a=x.currentSectionIndex>0,s=x.currentSectionIndex===(((R=n.sections)==null?void 0:R.length)||0)-1;return e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mt:4,pt:3,borderTop:"1px solid",borderColor:"divider"},children:[e.jsx(E,{variant:"outlined",startIcon:e.jsx(ge,{}),onClick:C,disabled:!a,sx:{borderColor:"primary.main",color:"primary.main"},children:x.currentSectionIndex===0?"Back to Welcome":"Previous"}),e.jsx(E,{variant:"contained",endIcon:s?void 0:e.jsx(et,{}),onClick:w,sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:s?"Complete Survey":"Next"})]})},L=()=>{var s;if(x.currentSectionIndex===-1)return O();if(x.isCompleted)return T();const a=(s=n.sections)==null?void 0:s[x.currentSectionIndex];return a?e.jsxs(r,{children:[I(),N(a,x.currentSectionIndex),v()]}):null};return e.jsxs(ze,{open:p,onClose:h,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{height:"90vh",maxHeight:"90vh",borderRadius:3}},children:[e.jsxs(Pe,{sx:{m:0,p:2,backgroundColor:"primary.main",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(be,{}),e.jsx(o,{variant:"h6",sx:{fontWeight:"bold"},children:"Survey Preview"})]}),e.jsx(B,{onClick:h,sx:{color:"white"},children:e.jsx(Xe,{})})]}),e.jsx(Ye,{sx:{p:0,overflow:"hidden"},children:e.jsx(oe,{maxWidth:"md",sx:{py:4,height:"100%",overflow:"auto"},children:L()})})]})},Ee=[{id:"basic-info",title:"Basic Information",description:"Survey title and description"},{id:"welcome",title:"Welcome Section",description:"Welcome message for participants"},{id:"questions",title:"Questions",description:"Add and configure survey questions"},{id:"thank-you",title:"Thank You Section",description:"Thank you message for participants"},{id:"review",title:"Review & Save",description:"Review your survey and save"}],mt=({survey:n,onComplete:p,onCancel:h})=>{const{updateSurvey:t,addSurvey:x}=Le(),j=dt({steps:Ee,initialStep:0}),[y,w]=S.useState(()=>n?{...n}:me()),[C,g]=S.useState(!1),D=S.useRef(n);S.useEffect(()=>{D.current!==n&&(n?w({...n}):(w(me()),j.resetWizard()),D.current=n)},[n]);const O=(T,I)=>{j.setStepDataValue(T,I);const v={...y};switch(T){case"basic-info":v.title=I.title||y.title,v.description=I.description||y.description;break;case"welcome":v.welcome={title:I.title||y.welcome.title,message:I.message||y.welcome.message};break;case"questions":v.sections=I.sections||y.sections;break;case"thank-you":v.thankYou={title:I.title||y.thankYou.title,message:I.message||y.thankYou.message};break}w(v)},Q=()=>{const T={...y,updatedAt:new Date().toISOString()};n?t(T):x(T),p(T)},N=T=>{const I=j.getStepData(T);switch(T){case"basic-info":return e.jsx(xt,{data:I,survey:y,onChange:v=>O(T,v)});case"welcome":return e.jsx(ut,{data:I,survey:y,onChange:v=>O(T,v)});case"questions":return e.jsx(pt,{data:I,survey:y,onChange:v=>O(T,v)});case"thank-you":return e.jsx(ht,{data:I,survey:y,onChange:v=>O(T,v)});case"review":return e.jsx(gt,{survey:y});default:return null}};return e.jsxs(r,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsxs(r,{sx:{backgroundColor:"primary.dark",color:"white",position:"fixed",top:0,left:"12.5%",right:"12.5%",zIndex:1200,height:64,display:"flex",alignItems:"center",px:3,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",borderBottomLeftRadius:12,borderBottomRightRadius:12},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:3,flex:1},children:[e.jsx(B,{onClick:h,sx:{mr:2,color:"white"},children:e.jsx(ge,{})}),e.jsx(r,{component:"img",src:"./CAPTRS_StackedLogo_White_Square-01-01.png",alt:"CAPTRS Logo",sx:{height:48,width:"auto",filter:"brightness(0) invert(1)",opacity:.95}}),e.jsx(o,{variant:"h6",sx:{fontWeight:"bold",fontFamily:'"DM Sans", sans-serif',lineHeight:1.2,letterSpacing:"-0.02em",ml:2},children:n?"Edit Survey":"Create New Survey"})]}),e.jsx(r,{sx:{display:"flex",alignItems:"center",gap:2},children:e.jsx(r,{sx:{width:32,height:32,borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white"},children:"ðŸ‘¤"})})]}),e.jsxs(oe,{maxWidth:"lg",sx:{py:4,pt:16,pb:20},children:[e.jsxs(z,{sx:{p:3,mb:3},children:[e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(o,{variant:"h6",children:["Step ",j.currentStepIndex+1," of ",j.totalSteps]}),e.jsx(o,{variant:"body2",color:"text.secondary",children:j.currentStep.title})]}),e.jsx(je,{variant:"determinate",value:(j.currentStepIndex+1)/j.totalSteps*100,sx:{height:8,borderRadius:4}})]}),e.jsx(z,{sx:{p:3,mb:3},children:e.jsx(r,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(E,{variant:"outlined",startIcon:e.jsx(be,{}),onClick:()=>g(!0),sx:{borderColor:"primary.main",color:"primary.main",px:4,py:1.5,"&:hover":{borderColor:"primary.dark",backgroundColor:"rgba(67, 88, 163, 0.04)"}},children:"Preview Survey"})})}),e.jsx(z,{sx:{p:3},children:e.jsx(tt,{activeStep:j.currentStepIndex,orientation:"vertical",children:Ee.map(T=>e.jsxs(rt,{children:[e.jsx(nt,{children:T.title}),e.jsx(st,{children:e.jsx(r,{sx:{mb:2},children:N(T.id)})})]},T.id))})})]}),e.jsx(r,{sx:{position:"fixed",bottom:0,left:"12.5%",right:"12.5%",backgroundColor:"white",borderTop:"1px solid",borderColor:"divider",boxShadow:"0 -2px 8px rgba(0,0,0,0.1)",zIndex:1100,py:3,px:4,borderTopLeftRadius:12,borderTopRightRadius:12},children:e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(E,{variant:"outlined",onClick:j.previousStep,disabled:j.isFirstStep,startIcon:e.jsx(ge,{}),sx:{minWidth:100},children:"Back"}),j.isLastStep?e.jsx(E,{variant:"contained",color:"success",onClick:Q,startIcon:e.jsx(he,{}),sx:{minWidth:140,backgroundColor:"success.main","&:hover":{backgroundColor:"success.dark"}},children:"Save Survey"}):e.jsx(E,{variant:"contained",onClick:j.nextStep,endIcon:e.jsx(he,{}),sx:{minWidth:120,backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"Next"})]})}),e.jsx(Ne,{survey:y,open:C,onClose:()=>g(!1)})]})},yt=()=>{var q;const{surveys:n,loading:p,deleteSurvey:h,duplicateSurvey:t}=Le(),[x,j]=S.useState(null),[y,w]=S.useState("library"),[C,g]=S.useState(0),[D,O]=S.useState(null),[Q,N]=S.useState({open:!1,message:"",severity:"success"}),[T,I]=S.useState({open:!1,survey:null}),v=(A,K="success")=>{N({open:!0,message:A,severity:K})},L=()=>{N(A=>({...A,open:!1}))},a=()=>{j(null),w("wizard")},s=A=>{j(A),w("wizard")},R=A=>{t(A),v("Survey duplicated successfully")},_=A=>{O(A)},G=A=>{I({open:!0,survey:A})},J=()=>{T.survey&&(h(T.survey.id),v("Survey deleted successfully"),I({open:!1,survey:null}))},$=A=>{try{at(A),v("Survey exported successfully")}catch{v("Failed to export survey","error")}},u=()=>{w("library"),g(A=>A+1),v("Survey saved successfully")},P=()=>{w("library"),j(null)};return p?e.jsxs(r,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(r,{sx:{backgroundColor:"primary.dark",color:"white",position:"fixed",top:0,left:"12.5%",right:"12.5%",zIndex:1200,height:64,display:"flex",alignItems:"center",px:3,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",borderBottomLeftRadius:12,borderBottomRightRadius:12},children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:3,flex:1},children:[e.jsx(r,{component:"img",src:"./CAPTRS_StackedLogo_White_Square-01-01.png",alt:"CAPTRS Logo",sx:{height:48,width:"auto",filter:"brightness(0) invert(1)",opacity:.95}}),e.jsx(o,{variant:"h6",sx:{fontWeight:"bold",fontFamily:'"DM Sans", sans-serif',lineHeight:1.2,letterSpacing:"-0.02em",ml:2},children:"CAPTRS Survey Builder"})]})}),e.jsxs(oe,{maxWidth:"lg",sx:{py:4,pt:12},children:[e.jsx(je,{}),e.jsx(o,{variant:"h6",sx:{mt:2,textAlign:"center"},children:"Loading Survey Library..."})]})]}):y==="wizard"?e.jsx(mt,{survey:x,onComplete:u,onCancel:P}):e.jsxs(r,{sx:{minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(r,{sx:{backgroundColor:"primary.dark",color:"white",position:"fixed",top:0,left:"12.5%",right:"12.5%",zIndex:1200,height:64,display:"flex",alignItems:"center",px:3,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",borderBottomLeftRadius:12,borderBottomRightRadius:12},children:e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:3,flex:1},children:[e.jsx(r,{component:"img",src:"./CAPTRS_StackedLogo_White_Square-01-01.png",alt:"CAPTRS Logo",sx:{height:48,width:"auto",filter:"brightness(0) invert(1)",opacity:.95}}),e.jsx(o,{variant:"h6",sx:{fontWeight:"bold",fontFamily:'"DM Sans", sans-serif',lineHeight:1.2,letterSpacing:"-0.02em",ml:2},children:"CAPTRS Survey Builder"})]})}),e.jsxs(oe,{maxWidth:"lg",sx:{py:4,pt:16,display:"flex",justifyContent:"center"},children:[e.jsxs(r,{sx:{backgroundColor:"white",borderRadius:3,boxShadow:"0 4px 16px rgba(0,0,0,0.08)",border:"1px solid",borderColor:"divider",p:4,position:"relative",width:"100%",maxWidth:1200},children:[e.jsxs(r,{sx:{mb:4,pb:3,borderBottom:"2px solid",borderColor:"divider",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(r,{children:[e.jsx(o,{variant:"h4",sx:{fontWeight:"bold",fontFamily:'"DM Sans", sans-serif',color:"primary.main",mb:1},children:"Survey Library"}),e.jsxs(o,{variant:"body1",sx:{color:"text.secondary",fontFamily:'"Open Sans", sans-serif',fontWeight:400},children:[n.length," survey",n.length!==1?"s":""," available"]})]}),e.jsx(E,{variant:"contained",size:"large",startIcon:e.jsx(H,{}),onClick:a,sx:{px:3,py:1.5,backgroundColor:"primary.main",color:"white",borderRadius:2,boxShadow:"0 2px 8px rgba(43, 61, 139, 0.2)","&:hover":{backgroundColor:"primary.dark",boxShadow:"0 4px 12px rgba(43, 61, 139, 0.3)",transform:"translateY(-1px)"},transition:"all 0.2s ease-in-out",ml:3},children:"Create New Survey"})]}),e.jsx(ct,{surveys:n,onEdit:s,onDuplicate:R,onDelete:G,onExport:$,onPreview:_},`library-${n.length}-${C}`)]}),e.jsxs(ze,{open:T.open,onClose:()=>I({open:!1,survey:null}),children:[e.jsx(Pe,{children:"Delete Survey"}),e.jsx(Ye,{children:e.jsxs(o,{children:['Are you sure you want to delete "',(q=T.survey)==null?void 0:q.title,'"? This action cannot be undone.']})}),e.jsxs(it,{children:[e.jsx(E,{onClick:()=>I({open:!1,survey:null}),children:"Cancel"}),e.jsx(E,{onClick:J,color:"error",variant:"contained",children:"Delete"})]})]}),e.jsx(ot,{open:Q.open,autoHideDuration:6e3,onClose:L,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(ae,{onClose:L,severity:Q.severity,children:Q.message})}),D&&e.jsx(Ne,{survey:D,open:!!D,onClose:()=>O(null)})]})]})},vt=Object.freeze(Object.defineProperty({__proto__:null,default:yt},Symbol.toStringTag,{value:"Module"}));export{jt as S,vt as a};
